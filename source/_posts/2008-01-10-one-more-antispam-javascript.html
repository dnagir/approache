---
layout: post
title: "One more AntiSpam JavaScript"
date: 2008-01-10T12:06:00+11:00
categories:
 - Development
---

<div class='post'>
<p>I often see how people struggle with email addresses like <strong>myemail  [at] mycomain [dot] com</strong>.</p> <p>This is fine on forums and other sites where you cannot emit your JavaScript  code, but it is really frustrating to see such emails on the <em>Contact  Me</em>-like pages on different sites.</p> <p>I just obfuscate the emails in JavaScript so people can click the links and  the same time avoid any spam.</p> <p>Lots of different email obfuscators are available in Internet. They can do it  online, so you can just copy-past the JS generated. But I just come up with my  own JavaScript antispam tool that I like.</p> <p>Let's have a look at part of HTML:</p> <div class="csharpcode"><pre class="alt">Contact Us: <span class="html">&lt;a</span> <span class="attr">id</span><span class="kwrd">="myMail"&gt;</span><span class="kwrd"></span>MyEmail [at] MyDomain [dot] com<span class="kwrd"><span class="html">&lt;/a&gt;</span></span></pre></div> <p> <style type="text/css">     .csharpcode, .csharpcode pre {  font-size: small;  color: black;  font-family: consolas, "Courier New", courier, monospace;  background-color: #ffffff;  /*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  {  background-color: #f4f4f4;  width: 100%;  margin: 0em; } .csharpcode .lnum { color: #606060; }</style> Then we have the JavaScript somewhere on a page:</p> <div class="csharpcode"><pre class="alt">antiSpam.mailTo(<span class="str">'myMail'</span>, {</pre><pre>  email: <span class="str">'MyEmail'</span>,  </pre><pre class="alt">  domain: ['MyDomain<span class="str">', '</span>com<span class="str">'],  </span></pre><pre>  //name: 'Support',  </pre><pre class="alt">  nameAsEmail: <span class="kwrd">true</span></pre><pre>});</pre></div> <div class="postBody" id="698addf4-dab7-42eb-9a4d-826c932d4eb7" contenteditable="true" style="border-width: 0px; margin: 4px 0px 0px; padding: 0px;"><style type="text/css">   .csharpcode, .csharpcode pre {  font-size: small;  color: black;  font-family: consolas, "Courier New", courier, monospace;  background-color: #ffffff;  /*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  {  background-color: #f4f4f4;  width: 100%;  margin: 0em; } .csharpcode .lnum { color: #606060; }</style>  <p>This will make a cliackable MAILTO link which is much more friendly for  users. If the browser doesn't support JavaScript it will do nothing and leave  default ANCHOR tag. So the email will be visible, but not clickable and not  friendly.</p> <p>The mailTo function has two parameters. First - the ID of the anchor tag  which should be modified. The second parameter is actually set of options.  <strong>Bolded</strong> are required parameters to make it working:</p> <ul><li><strong><em>email</em></strong> - the email's recipient string or array. If  it's an array - the resulting address will be separated with dots. For example:  <ul><li><em>email: 'support'</em>.  </li><li><em>email: ['dmitriy', 'nagirnyak']</em>. </li></ul> </li><li><strong><em>domain</em></strong> - the recipient's domain name string or  array. If it's an array - the resulting domain will be separated with dots. For  example:  <ul><li><em>domain: 'MyDomain.com'</em>.  </li><li><em>domain: ['MyDomain', 'com']</em>. </li></ul> </li><li><em>name</em> - the text to be shown on the link. If not specified test will  not be modified or will be the same as full email address. See next option:  </li><li><em>nameAsEmail</em> - if the <em>name</em> is not specified and this one is  set, then text of the link will become the actual email address. </li></ul> <p> </p> <p>The actual JavaScript code (that should be included/embedded of course into  the page) is:</p> <div class="csharpcode"><pre class="alt"><span class="kwrd">var</span> antiSpam = {</pre><pre>    toSeparatedString: <span class="kwrd">function</span>(obj, delimiter) {</pre><pre class="alt">        <span class="kwrd">if</span> (!obj) <span class="kwrd">return</span> <span class="kwrd">null</span>;</pre><pre>        <span class="kwrd">if</span> (<span class="kwrd">typeof</span>(obj) == <span class="str">'string'</span>) <span class="kwrd">return</span> obj;</pre><pre class="alt">        <span class="kwrd">var</span> res = <span class="str">''</span>;</pre><pre> </pre><pre class="alt">        <span class="kwrd">for</span> (<span class="kwrd">var</span> i=0; i&lt;obj.length; i++) {<pre>            <span class="kwrd">if</span> (i > 0 &amp;&amp; delimiter) res += delimiter;</pre><pre class="alt">            res += obj[i];</pre><pre>        }</pre><pre class="alt">        <span class="kwrd">return</span> res;</pre><pre>    },</pre><pre class="alt"> </pre><pre>    mailTo: <span class="kwrd">function</span>(id, parameters) {        </pre><pre class="alt">        <span class="kwrd">if</span> (!parameters) <span class="kwrd">return</span>;</pre><pre>        <span class="kwrd">var</span> a = document.getElementById(id);</pre><pre class="alt">        <span class="kwrd">if</span> (!a) <span class="kwrd">return</span>;</pre><pre> </pre><pre class="alt">        <span class="kwrd">var</span> email = <span class="kwrd">this</span>.toSeparatedString(parameters.email, <span class="str">'.'</span>);</pre><pre>        <span class="kwrd">if</span> (!email) <span class="kwrd">return</span>;</pre><pre class="alt"> </pre><pre>        <span class="kwrd">var</span> domain = <span class="kwrd">this</span>.toSeparatedString(parameters.domain, <span class="str">'.'</span>);</pre><pre class="alt">        <span class="kwrd">if</span> (!domain) <span class="kwrd">return</span>;</pre><pre> </pre><pre class="alt">        email = email + <span class="str">'@'</span> + domain;</pre><pre>        a.href = <span class="str">'mailto:'</span> + email;</pre><pre class="alt">        <span class="kwrd">if</span> (!parameters.name) {</pre><pre>            <span class="kwrd">if</span> (parameters.nameAsEmail) {</pre><pre class="alt">                a.innerHTML = email;</pre><pre>            }</pre><pre class="alt">        }</pre><pre>        <span class="kwrd">else</span></pre><pre class="alt">            a.innerHTML = parameters.name;</pre><pre>    }</pre><pre class="alt">}</pre></pre></div> <style type="text/css">  .csharpcode, .csharpcode pre {  font-size: small;  color: black;  font-family: consolas, "Courier New", courier, monospace;  background-color: #ffffff;  /*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  {  background-color: #f4f4f4;  width: 100%;  margin: 0em; } .csharpcode .lnum { color: #606060; }</style>  <p> </p> <p>Happy coding!</p></div></div>
